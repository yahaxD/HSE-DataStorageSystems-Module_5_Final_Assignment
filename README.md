# –ò—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—é 5 - –ö—É—Ä—Å "–°–∏—Å—Ç–µ–º—ã –•—Ä–∞–Ω–µ–Ω–∏—è –î–∞–Ω–Ω—ã—Ö"

## üß© –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Data Vault 2.0** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö **SampleSuperstore.csv**.  

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ö–∞—Ç–∞–ª–æ–≥ / –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------------|------------|
| `SampleSuperstore.csv` | –ò—Å—Ö–æ–¥–Ω—ã–π CSV-—Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö, –¥–æ—Å—Ç–∞–≤–∫–µ –∏ —Ç–æ–≤–∞—Ä–∞—Ö |
| `DataVault_diagram.png` | –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã |
| `data_check.png` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä–∑—É–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ DataVualt |
| `sql/DataVault_structure.sql` | DDL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü Data Vault |
| `sql/load_hub_shipment` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí HUB_SHIPMENT |
| `sql/load_hub_segment` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí HUB_SEGMEN|
| `sql/load_hub_location` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí HUB_LOCATION |
| `sql/load_hub_product` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí HUB_PRODUCT |
| `sql/load_link_sale` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí LINK_SALE |
| `sql/load_sat_product_attr` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí SAT_PRODUCT_ATTR |
| `sql/load_sat_location_attr` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí SAT_LOCATION_ATTR |
| `sql/load_sat_sale_facts` | DDM-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∞ stage ‚Üí SAT_SALE_FACTS |
| `README.md` | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ |

---

## üìÑ –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª `SampleSuperstore.csv`


**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü–æ–ª—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|------|-----------|
| **Shipment** | Ship Mode | –°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ |
| **Customer Class** | Segment | –°–µ–≥–º–µ–Ω—Ç –∫–ª–∏–µ–Ω—Ç–∞ |
| **Location** | Country, City, State, Postal Code, Region | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| **Product** | Category, Sub-Category | –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞ |
| **Stats** | Sales, Quantity, Discount, Profit | –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥–∞–∂ |

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Data Vault

### üèóÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

#### **–•–∞–±—ã**
| –•–∞–± | –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|--------------|------------|
| `HUB_SHIPMENT` | Ship Mode | –°–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏ |
| `HUB_SEGMENT` | Segment | –°–µ–≥–º–µ–Ω—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `HUB_LOCATION` | Country + City + Postal Code | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞ |
| `HUB_PRODUCT` | Category + Sub-Category | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ |

#### **–õ–∏–Ω–∫**
| –õ–∏–Ω–∫ | –°–æ–µ–¥–∏–Ω—è–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|------------|
| `LINK_SALE` | Shipment + Segment + Location + Product | –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–¥–∞–∂–∏ (—Ñ–∞–∫—Ç —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ö–∞–±–æ–≤) |

#### **–°–ø—É—Ç–Ω–∏–∫–∏**
| –°–ø—É—Ç–Ω–∏–∫ | –ü—Ä–∏–≤—è–∑–∞–Ω –∫ | –°–æ–¥–µ—Ä–∂–∏—Ç | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|-------------|-----------|-------------|
| `SAT_PRODUCT_ATTR` | HUB_PRODUCT | Category, Sub-Category | –ê—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–∞ |
| `SAT_LOCATION_ATTR` | HUB_LOCATION | Country, State, City, Region, Postal Code | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã |
| `SAT_SALE_FACTS` | LINK_SALE | Sales, Quantity, Discount, Profit | –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–¥–∞–∂ |

![–î–∏–∞–≥—Ä–∞–º–º–∞ Data Vault](DataVault_diagram.png)

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** `MD5()`  
  - –î–ª—è –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–µ–π (Hub Keys, Link Keys)  
  - –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è `hashdiff` –≤ —Å–ø—É—Ç–Ω–∏–∫–∞—Ö
- **PK –≤ —Å–ø—É—Ç–Ω–∏–∫–∞—Ö:** `(business_hashkey, hashdiff)`  
  - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –∫–ª—é—á—É –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `loaddate`
- **–ê—Ç—Ä–∏–±—É—Ç—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
  - `loaddate` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–∏  
  - `recordsource` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (`'CSV_SUPERSTORE'`)

 ---
 
## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ stage-—Ç–∞–±–ª–∏—Ü—ã

Stage-—Ç–∞–±–ª–∏—Ü–∞ —Å–ª—É–∂–∏—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º —Å–ª–æ–µ–º –º–µ–∂–¥—É –∏—Å—Ö–æ–¥–Ω—ã–º CSV-—Ñ–∞–π–ª–æ–º –∏ –º–æ–¥–µ–ª—å—é Data Vault.  
–û–Ω–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Ö—ç—à-–∫–ª—é—á–µ–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ —Ö–∞–±—ã, –ª–∏–Ω–∫–∏ –∏ —Å–ø—É—Ç–Ω–∏–∫–∏.

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É c –ø–æ–º–æ—â—å—é DDL-—Å–∫—Ä–∏–ø—Ç–∞ srg_superstor.sql
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV —á–µ—Ä–µ–∑ DBeaver:
    –ü–ö–ú ‚Üí –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö ‚Üí CSV ‚Üí stg_superstore (–§–æ—Ä–º–∞—Ç: CSV, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ",", –∫–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8, –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ ‚úÖ)

### 2Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ö–∞–±—ã (HUB)

–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º DDM-—Å–∫—Ä–∏–ø—Ç—ã load_hub_product.sql, load_hub_location.sql, load_hub_segment.sql, load_hub_shipment.sql, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ stage-—Ç–∞–±–ª–∏—Ü—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ö—ç—à-–∫–ª—é—á–∏ MD5 –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—ã HUB_PRODUCT, HUB_LOCATION, HUB_SEGMENT, HUB_SHIPMENT.

### 3Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏–Ω–∫–∏ (LINK)

–¢–∞–±–ª–∏—Ü–∞ LINK_SALE —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Ö–∞–±—ã –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç ‚Äú—Ñ–∞–∫—Ç‚Äù –ø—Ä–æ–¥–∞–∂–∏.
–•—ç—à-–∫–ª—é—á –ª–∏–Ω–∫–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –∏–∑ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ö—ç—à-–∫–ª—é—á–µ–π –≤—Å–µ—Ö —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö —Ö–∞–±–æ–≤.
–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–æ–¥—É–∫—Ç–æ–º, –ª–æ–∫–∞—Ü–∏–µ–π, —Å–µ–≥–º–µ–Ω—Ç–æ–º –∏ —Ç–∏–ø–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ c –ø–æ–º–æ—â—å—é DDM-—Å–∫—Ä–∏–ø—Ç–∞ load_link_sale.sql

### 4Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ø—É—Ç–Ω–∏–∫–∏ (SATELLITE)

–°–ø—É—Ç–Ω–∏–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã.
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø—É—Ç–Ω–∏–∫–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è HashDiff ‚Äî —Ö—ç—à –æ—Ç –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (SCD Type 2).
–î–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ DDM-—Å–∫—Ä–∏–ø—Ç—ã: load_sat_location_attr.sql, load_sat_product_attr.sql, load_sat_sale_facts.sql

### 5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

![–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ DataVault](data_check.jpg)
